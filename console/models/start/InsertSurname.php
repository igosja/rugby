<?php

// TODO refactor

namespace console\models\start;

use common\components\helpers\ErrorHelper;
use common\models\db\Country;
use common\models\db\Surname;
use common\models\db\SurnameCountry;
use Exception;
use Yii;

/**
 * Class InsertSurname
 * @package console\models\start
 */
class InsertSurname
{
    /**
     * @return void
     * @throws Exception
     */
    public function execute()
    {
        $engSurname = [
            'Abramson',
            'Adamson',
            'Adderiy',
            'Addington',
            'Adrian',
            'Albertson',
            'Aldridge',
            'Allford',
            'Alsopp',
            'Anderson',
            'Andrews',
            'Archibald',
            'Arnold',
            'Arthurs',
            'Atcheson',
            'Attwood',
            'Audley',
            'Austin',
            'Ayrton',
            'Babcock',
            'Backer',
            'Baldwin',
            'Bargeman',
            'Barnes',
            'Barrington',
            'Bawerman',
            'Becker',
            'Benson',
            'Berrington',
            'Birch',
            'Bishop',
            'Black',
            'Blare',
            'Blomfield',
            'Boolman',
            'Bootman',
            'Bosworth',
            'Bradberry',
            'Bradshaw',
            'Brickman',
            'Brooks',
            'Brown',
            'Bush',
            'Calhoun',
            'Campbell',
            'Carey',
            'Carrington',
            'Carroll',
            'Carter',
            'Chandter',
            'Chapman',
            'Charlson',
            'Chesterton',
            'Clapton',
            'Clifford',
            'Coleman',
            'Conors',
            'Cook',
            'Cramer',
            'Creighton',
            'Croftoon',
            'Crossman',
            'Daniels',
            'Davidson',
            'Day',
            'Dean',
            'Derrick',
            'Dickinson',
            'Dodson',
            'Donaldson',
            'Donovan',
            'Douglas',
            'Dowman',
            'Dutton',
            'Duncan',
            'Dunce',
            'Durham',
            'Dyson',
            'Eddington',
            'Edwards',
            'Ellington',
            'Elmers',
            'Enderson',
            'Erickson',
            'Evans',
            'Faber',
            'Fane',
            'Farmer',
            'Farrell',
            'Ferguson',
            'Finch',
            'Fisher',
            'Fitzgerald',
            'Flannagan',
            'Flatcher',
            'Fleming',
            'Ford',
            'Forman',
            'Forster',
            'Foster',
            'Francis',
            'Fraser',
            'Freeman',
            'Fulton',
            'Galbraith',
            'Gardner',
            'Garrison',
            'Gate',
            'Gerald',
            'Gibbs',
            'Gilbert',
            'Gill',
            'Gilmore',
            'Gilson',
            'Gimson',
            'Goldman',
            'Goodman',
            'Gustman',
            'Haig',
            'Hailey',
            'Hamphrey',
            'Hancock',
            'Hardman',
            'Harrison',
            'Hawkins',
            'Higgins',
            'Hodges',
            'Hoggarth',
            'Holiday',
            'Holmes',
            'Howard',
            'Jacobson',
            'James',
            'Jeff',
            'Jenkin',
            'Jerome',
            'Johnson',
            'Jones',
            'Keat',
            'Kelly',
            'Kendal',
            'Kennedy',
            'Kennett',
            'Kingsman',
            'Kirk',
            'Laird',
            'Lamberts',
            'Larkins',
            'Lawman',
            'Leapman',
            'Leman',
            'Lewin',
            'Little',
            'Livingston',
            'Longman',
            'MacAdam',
            'MacAlister',
            'MacDonald',
            'Macduff',
            'Macey',
            'Mackenzie',
            'Mansfield',
            'Marlow',
            'Marshman',
            'Mason',
            'Mathews',
            'Mercer',
            'Michaelson',
            'Miers',
            'Miller',
            'Miln',
            'Milton',
            'Molligan',
            'Morrison',
            'Murphy',
            'Nash',
            'Nathan',
            'Neal',
            'Nelson',
            'Nevill',
            'Nicholson',
            'Nyman',
            'Oakman',
            'Ogden',
            'Oldman',
            'Oldridge',
            'Oliver',
            'Osborne',
            'Oswald',
            'Otis',
            'Owen',
            'Page',
            'Palmer',
            'Parkinson',
            'Parson',
            'Pass',
            'Paterson',
            'Peacock',
            'Pearcy',
            'Peterson',
            'Philips',
            'Porter',
            'Quincy',
            'Raleigh',
            'Ralphs',
            'Ramacey',
            'Reynolds',
            'Richards',
            'Roberts',
            'Roger',
            'Russel',
            'Ryder',
            'Salisburry',
            'Salomon',
            'Samuels',
            'Saunder',
            'Shackley',
            'Sheldon',
            'Sherlock',
            'Shorter',
            'Simon',
            'Simpson',
            'Smith',
            'Stanley',
            'Stephen',
            'Stevenson',
            'Sykes',
            'Taft',
            'Taylor',
            'Thomson',
            'Thorndike',
            'Thornton',
            'Timmons',
            'Tracey',
            'Turner',
            'Vance',
            'Vaughan',
            'Wainwright',
            'Walkman',
            'Wallace',
            'Waller',
            'Walter',
            'Ward',
            'Warren',
            'Watson',
            'Wayne',
            'Webster',
            'Wesley',
            'White',
            'Wilkinson',
            'Winter',
            'Wood',
            'Youmans',
            'Young',
        ];
        $argSurname = [
            'Aguilar',
            'Alonso',
            'Alvarez',
            'Arias',
            'Benitez',
            'Blanco',
            'Bravo',
            'Caballero',
            'Calvo',
            'Campos',
            'Cano',
            'Carmona',
            'Carrasco',
            'Castillo',
            'Castro',
            'Cortes',
            'Cruz',
            'Delgado',
            'Diaz',
            'Diez',
            'Dominguez',
            'Duran',
            'Esteban',
            'Fernandez',
            'Ferrer',
            'Flores',
            'Fuentes',
            'Gallardo',
            'Gallego',
            'Garcia',
            'Garrido',
            'Gimenez',
            'Gomez',
            'Gonzalez',
            'Guerrero',
            'Gutierrez',
            'Hernandez',
            'Herrera',
            'Herrero',
            'Hidalgo',
            'Iglesias',
            'Jimenez',
            'Lopez',
            'Lorenzo',
            'Marquez',
            'Martinez',
            'Medina',
            'Mendez',
            'Molina',
            'Montero',
            'Mora',
            'Morales',
            'Moreno',
            'Navarro',
            'Nieto',
            'Ortega',
            'Ortiz',
            'Parra',
            'Pascual',
            'Pastor',
            'Pena',
            'Perez',
            'Ramirez',
            'Ramos',
            'Rey',
            'Reyes',
            'Rodriguez',
            'Romero',
            'Rubio',
            'Ruiz',
            'Saez',
            'Sanchez',
            'Santana',
            'Santiago',
            'Santos',
            'Sanz',
            'Serrano',
            'Suarez',
            'Torrez',
            'Vargaz',
            'Vazquez',
            'Vega',
            'Velasco',
            'Vincente',
        ];
        $fraSurname = [
            'Abel',
            'Abraham',
            'Adam',
            'Albert',
            'Allard',
            'Andre',
            'Archambault',
            'Arthur',
            'Augustin',
            'Babin',
            'Babineaux',
            'Barre',
            'Baudin',
            'Beauchêne',
            'Beaufort',
            'Beaulieu',
            'Beaumont',
            'Belanger',
            'Bellamy',
            'Bellerose',
            'Belmont',
            'Belrose',
            'Beranger',
            'Berger',
            'Beringer',
            'Bernard',
            'Bertrand',
            'Blaise',
            'Blanc',
            'Blanchar',
            'Blanchet',
            'Blanchett',
            'Boivin',
            'Bonfils',
            'Bonheur',
            'Bonhomme',
            'Bonnaire',
            'Bonnay',
            'Bonnet',
            'Borde',
            'Bouchard',
            'Boucher',
            'Bourdillon',
            'Bourreau',
            'Bret',
            'Brisbois',
            'Brodeur',
            'Bureau',
            'Caron',
            'Chaput',
            'Charbonneau',
            'Charpentier',
            'Charron',
            'Chastain',
            'Chevalier',
            'Chevrolet',
            'Christian',
            'Clement',
            'Cloutier',
            'Colbert',
            'Comtois',
            'Coste',
            'Cote',
            'Courtemanche',
            'Cousineau',
            'Couture',
            'D’Aramitz',
            'Daniau',
            'Daniel',
            'Daviau',
            'David',
            'De La Fontaine',
            'Deforest',
            'Degarmo',
            'Delacroix',
            'Deniau',
            'Deniaud',
            'Deniel',
            'Denis',
            'Dennel',
            'Deschamps',
            'Descoteaux',
            'Desjardins',
            'Desroches',
            'Desrosiers',
            'Droit',
            'Dubois',
            'Duchamps',
            'Dufort',
            'Dufour',
            'Duguay',
            'Dumont',
            'Dupond',
            'Dupont',
            'Durand',
            'Durant',
            'Duval',
            'Emile',
            'Fabien',
            'Fabre',
            'Fabron',
            'Faucher',
            'Faucheux',
            'Faure',
            'Favager',
            'Favre',
            'Favreau',
            'Fay',
            'Felix',
            'Fevre',
            'Firmin',
            'Fontaine',
            'Forest',
            'Forestier',
            'Fortier',
            'Fosse',
            'Fournier',
            'François',
            'Gage',
            'Gagneux',
            'Gagnier',
            'Gagnon',
            'Garçon',
            'Gardinier',
            'Garnier',
            'Gauthier',
            'Germain',
            'Geroux',
            'Girard',
            'Giroux',
            'Gosse',
            'Gosselin',
            'Granger',
            'Gros',
            'Guerin',
            'Guillory',
            'Hardy',
            'Hebert',
            'Herbert',
            'Jacques',
            'Janvier',
            'Jordan',
            'Joubert',
            'Labelle',
            'Lachance',
            'Lachapelle',
            'Lamar',
            'Lambert',
            'Lane',
            'Langlais',
            'Langlois',
            'Lapointe',
            'Larue',
            'Laurent',
            'Lavigne',
            'Lavoie',
            'Leandres',
            'Lebeau',
            'Leblanc',
            'Leclair',
            'Leclerc',
            'Lecuyer',
            'Lefebvre',
            'Lefevre',
            'Lefurgey',
            'Legrand',
            'Lemaire',
            'Lemieux',
            'Leon',
            'Leroy',
            'Lesauvage',
            'Lestrange',
            'Leveque',
            'Levesque',
            'Linville',
            'Lucas',
            'Lyon',
            'Maçon',
            'Marchand',
            'Marie',
            'Marion',
            'Martel',
            'Martin',
            'Masson',
            'Mathieu',
            'Mercier',
            'Merle',
            'Michaud',
            'Michel',
            'Monet',
            'Monette',
            'Montagne',
            'Moreau',
            'Morel',
            'Moulin',
            'Mullins',
            'Nicolas',
            'Noel',
            'Noyer',
            'Olivier',
            'Paget',
            'Palomer',
            'Pan',
            'Pape',
            'Paquet',
            'Paquet',
            'Parent',
            'Paris',
            'Parris',
            'Pascal',
            'Patenaude',
            'Paternoster',
            'Paul',
            'Pelletier',
            'Perrault',
            'Perreault',
            'Perrin',
            'Perrot',
            'Petit',
            'Pettigrew',
            'Pierre',
            'Plamondon',
            'Plourde',
            'Poirier',
            'Porcher',
            'Poulin',
            'Proulx',
            'Renaud',
            'Rey',
            'Reyer',
            'Richard',
            'Richelieu',
            'Robert',
            'Roche',
            'Rome',
            'Romilly',
            'Rose',
            'Rousseau',
            'Roussel',
            'Roux',
            'Roy',
            'Royer',
            'Salmon',
            'Salomon',
            'Samson',
            'Samuel',
            'Sartre',
            'Sault',
            'Sauvage',
            'Sauvageau',
            'Sauvageon',
            'Sauvageot',
            'Sauveterre',
            'Savatier',
            'Segal',
            'Sergeant',
            'Severin',
            'Simon',
            'Soucy',
            'Sourd',
            'Tailler',
            'Tasse',
            'Thayer',
            'Thibault',
            'Thomas',
            'Traver',
            'Travere',
            'Travers',
            'Traverse',
            'Travert',
            'Tremblay',
            'Tremble',
            'Victor',
            'Villeneuve',
            'Vincent',
            'Voclain',
        ];
        $itaSurname = [
            'Abruzzo',
            'Accardi',
            'Agosti',
            'Albertelli',
            'Alfonsi',
            'Allegra',
            'Amato',
            'Argento',
            'Armani',
            'Bambino',
            'Barbieri',
            'Barilla',
            'Barone',
            'Bellucci',
            'Berlusconi',
            'Bernardi',
            'Bertelli',
            'Bianchi',
            'Bianco',
            'Borghese',
            'Brambilla',
            'Bruni',
            'Bruno',
            'Caputo',
            'Carbone',
            'Carozza',
            'Caruso',
            'Cattaneo',
            'Colombo',
            'Conte',
            'Coppola',
            'Costa',
            'D’Angelo',
            'De Luca',
            'De Santis',
            'DeVille',
            'Di Fazio',
            'Donato',
            'Esposito',
            'Fabbri',
            'Farina',
            'Favero',
            'Ferrante',
            'Ferrari',
            'Ferrucci',
            'Fiore',
            'Fontana',
            'Galilei',
            'Gallo',
            'Gatti',
            'Gentile',
            'Gianni',
            'Giordano',
            'Grasso',
            'Greco',
            'Guerra',
            'Guerriero',
            'Guiluliani',
            'Lamberti',
            'Leone',
            'Lioni',
            'Lombardi',
            'Longo',
            'Magnifico',
            'Mancini',
            'Marchetti',
            'Mariano',
            'Marino',
            'Martini',
            'Mazza',
            'Messina',
            'Monti',
            'Morelli',
            'Moretti',
            'Negri',
            'Nicastro',
            'Nicoli',
            'Orsini',
            'Palumbo',
            'Parisi',
            'Pellegrini',
            'Puddu',
            'Puma',
            'Quattro',
            'Rabito',
            'Raffa',
            'Ranallo',
            'Ricci',
            'Romano',
            'Rossi',
            'Russo',
            'Sala',
            'Sanna',
            'Santoro',
            'Sartori',
            'Scotti',
            'Segreto',
            'Silvestri',
            'Sorrento',
            'Tedesco',
            'Uberti',
            'Valentino',
            'Venturi',
            'Verga',
            'Villa',
            'Vinci',
            'Vitale',
            'Zappa',
            'Zunino',
        ];

        $surnameArray = [
            [
                'country' => 'England',
                'list' => $engSurname,
            ],
            [
                'country' => 'Ireland',
                'list' => $engSurname,
            ],
            [
                'country' => 'Scotland',
                'list' => $engSurname,
            ],
            [
                'country' => 'Wales',
                'list' => $engSurname,
            ],
            [
                'country' => 'Australia',
                'list' => $engSurname,
            ],
            [
                'country' => 'Argentina',
                'list' => $argSurname,
            ],
            [
                'country' => 'France',
                'list' => $fraSurname,
            ],
            [
                'country' => 'Italy',
                'list' => $itaSurname,
            ],
            [
                'country' => 'New Zealand',
                'list' => $engSurname,
            ],
            [
                'country' => 'South Africa',
                'list' => $engSurname,
            ],
        ];

        $data = [];
        foreach ($surnameArray as $country) {
            $countryId = Country::find()
                ->select(['country_id'])
                ->where(['country_name' => $country['country']])
                ->limit(1)
                ->scalar();

            $country['list'] = array_unique($country['list']);

            $surnameCountryList = Surname::find()
                ->where(['surname_name' => $country['list']])
                ->indexBy(['surname_name'])
                ->all();
            foreach ($country['list'] as $item) {
                if (isset($surnameCountryList[$item])) {
                    $data[] = [$countryId, $surnameCountryList[$item]->surname_id];
                    continue;
                }

                $transaction = Yii::$app->db->beginTransaction();
                try {
                    $surname = new Surname();
                    $surname->surname_name = $item;
                    $surname->save();
                    $transaction->commit();
                    $data[] = [$countryId, $surname->surname_id];
                } catch (Exception $e) {
                    $transaction->rollBack();
                    ErrorHelper::log($e);
                }
            }
        }

        Yii::$app->db
            ->createCommand()
            ->batchInsert(
                SurnameCountry::tableName(),
                ['surname_country_country_id', 'surname_country_surname_id'],
                $data
            )
            ->execute();
    }
}
